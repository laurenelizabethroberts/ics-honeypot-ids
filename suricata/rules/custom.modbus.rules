# Minimal custom Modbus rules for Conpot demo
alert tcp any any -> $HOME_NET 502 (msg:"MODBUS Read Coils to PLC"; flow:to_server,established; app-layer-protocol:modbus; modbus.func_code:1; classtype:attempted-recon; sid:1000001; rev:1;)
alert tcp any any -> $HOME_NET 502 (msg:"MODBUS Bulk Read Holding Registers (quantity > 64)"; flow:to_server,established; app-layer-protocol:modbus; modbus.func_code:3; content:"|00 41|"; distance:4; within:2; classtype:attempted-recon; sid:1000002; rev:1;)
